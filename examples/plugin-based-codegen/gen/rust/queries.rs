// Code generated by sqlc-gen-rust. DO NOT EDIT.
// Engine: sqlite3

use sqlx::{FromRow, SqlitePool};
use anyhow::Result;

#[derive(Debug, FromRow)]
pub struct Users {
}

#[derive(Debug, FromRow)]
pub struct Posts {
}

/// GetUser
pub async fn get_user(
    pool: &SqlitePool,
) -> Result<()> {
    const QUERY: &str = "SELECT * FROM users WHERE id = ?;";
    let row = sqlx::query_as(QUERY)
        .fetch_optional(pool)
        .await?;
    Ok(row)
}

/// ListUsers
pub async fn list_users(
    pool: &SqlitePool,
) -> Result<()> {
    const QUERY: &str = "SELECT * FROM users ORDER BY name;";
    let rows = sqlx::query_as(QUERY)
        .fetch_all(pool)
        .await?;
    Ok(rows)
}

/// CreateUser
pub async fn create_user(
    pool: &SqlitePool,
) -> Result<()> {
    const QUERY: &str = "INSERT INTO users (id, name, email) VALUES (?, ?, ?);";
    sqlx::query(QUERY)
        .execute(pool)
        .await?;
    Ok(())
}

/// GetUserPosts
pub async fn get_user_posts(
    pool: &SqlitePool,
) -> Result<()> {
    const QUERY: &str = "SELECT * FROM posts WHERE user_id = ? ORDER BY created_at DESC;";
    let rows = sqlx::query_as(QUERY)
        .fetch_all(pool)
        .await?;
    Ok(rows)
}

/// CreatePost
pub async fn create_post(
    pool: &SqlitePool,
) -> Result<()> {
    const QUERY: &str = "INSERT INTO posts (id, user_id, title, body) VALUES (?, ?, ?, ?);";
    sqlx::query(QUERY)
        .execute(pool)
        .await?;
    Ok(())
}

